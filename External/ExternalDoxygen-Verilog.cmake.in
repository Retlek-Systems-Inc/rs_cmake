cmake_minimum_required(VERSION 2.8.2)
set(_target verilator)

project(${_target}-download NONE)
include(ExternalProject)

ExternalProject_Add(verilator
  GIT_REPOSITORY    http://git.veripool.org/git/verilator
  GIT_TAG           stable
  SOURCE_DIR        "${CMAKE_BINARY_DIR}/${_target}-src"
  CONFIGURE_COMMAND "autoconf && ./configure --prefix="
  PREFIX            ${CMAKE_BINARY_DIR}/${_target}-src"
  BUILD_COMMAND     ${MAKE}
  BUILD_IN_SOURCE   1
#  INSTALL_COMMAND   "sudo ${MAKE} install"
  TEST_COMMAND      "${MAKE} test"
  UPDATE_DISCONNECTED 1
  LOG_DOWNLOAD ON
  LOG_CONFIGURE ON
  LOG_BUILD ON
)